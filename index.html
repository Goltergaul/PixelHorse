<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Sample App</title>
    <script type="text/javascript" src='lib/jquery.js'></script>
    <script type="text/javascript" src='lib/pixelhorse/pixelhorse.js'></script>
  </head>
  <body>
  <script type="text/javascript">
    $(document).ready(function() {
      var scene = new ph.Scene($("#scene"));
      
      js_pic = new ph.BitmapCanvas("/app/js.png");
      js_pic2 = new ph.BitmapCanvas("/app/js2.png");
      js_pic3 = new ph.BitmapCanvas("/app/js3.gif");
      some_text = new ph.TextCanvas("Hello World");
      scene.addDrawable(js_pic),
      js_pic.addDrawable(js_pic2);
      js_pic.addDrawable(js_pic3);
      scene.addDrawable(some_text);
      some_text.setPosition(10,100);
      
      js_pic2.setPosition(20,20);
      
      ph.AssetManager.addAsset(js_pic3, "monkey");
      delete js_pic3;

      try {
        js_pic3.setPosition(-30,-10);
      }
      catch(e) {
        console.log("js_pic3 is undefined, let's get it from the asset Manager:", e.message);
      }
      finally {
        js_pic3 = ph.AssetManager.getAsset("monkey");
        js_pic3.setPosition(-30,-10);
      }
      
      // try sprites
      var sprite = new ph.SpriteCanvas("/app/GRASS01.bmp", 40, 40, 40, 81);
      scene.addDrawable(sprite);
      
      var clock = new ph.ClockGenerator(update, scene.draw);
      var keyboard = new ph.Keyboard();

      function update(dt) {
        var x = js_pic.x;
        if(keyboard.pressed["68"])
          js_pic.setPosition(js_pic.x+1*dt/10,0);
          
        var offset =  viewport.getOffsets();
        if(keyboard.pressed["39"]) {
          offset[0] += 1*dt/10;
          viewport.setOffset(offset[0], offset[1]);  
        }
          
        some_text.text = "FPS: " + Math.round(1000 / clock.averageDt);
      }
      
      var viewport = new ph.Viewport();
      viewport.setOffset(-100,-100)
      js_pic.addViewport(viewport);
      
      loadManager = new ph.LoadManager();
      loadManager.monitorLoading(function(percent) {
        return $("#loadingPercent").text(percent);
      });

      $(document).bind("AssetsLoaded", function() {
        clock.start();
      });
    });
  </script>
    <div id="loadingPercent"></div>
    <div style="width:800px; height:600px" id="scene"></div>
  
  </body>
</html>